annotatedPeakEnsTSS<-annotatePeakInBatch(peaks.range,AnnotationData=tss.range,output="both",multiple=T,maxgap=0)
dim(geneIds)
annotatedPeakEnsTSS[1:3,]
annotatedPeakEnsTSS$insideFeature[1:3,]
annotatedPeakEnsTSS$insideFeature[1:3]
annotatedPeakEnsTSS$insideFeature[1:3 == "upstream"]
test <- annotatedPeakEnsTSS$insideFeature[$insideFeature=="upstream"]
test <- annotatedPeakEnsTSS$insideFeature[annotatedPeakEnsTSS$insideFeature=="upstream"]
dim(test)
length(test)
dim(annotatedPeakEnsTSS)
test <- annotatedPeakEnsTSS[annotatedPeakEnsTSS$insideFeature=="upstream"]
rm(test)
test <- annotatedPeakEnsTSS[annotatedPeakEnsTSS$insideFeature=="upstream"]
test <- annotatedPeakEnsTSS$insideFeature=="upstream"
dim(test)
length(test)
test[1:5]
rm(test)
test <- annotatedPeakEnsTSS[annotatedPeakEnsTSS$insideFeature=="upstream",]
dim(test)
test[1:5,]
test[1:25,]
as.factor(test$insideFeature)
summary(as.factor(annotatedPeakEnsTSS$insideFeature)
)
annotatedPeakEnsTSS<-annotatePeakInBatch(peaks.range,AnnotationData=tss.range,output="both",multiple=T,maxgap=0)
peaks.range[1:10,]
peaks.range$strand[1:3]
peaks.range$strand <- "*"
peaks.range[1:10,]
peaks.range$strand <- "+"
dim(peaks)
> > > > > > > dim(peaks.range)
dim(peaks.range)
class(ensMgi)
dim(ensMgi)
warnings()
dim(ensMgi)
ensMgi[1:5,]
merge(ensMgi,annotatedPeakEnsTSS.df,by = intersect(ensMgi$ensembl_gene_id,annotatedPeakEnsTSS.df$feature),all=TRUE,sort=F)
merge(ensMgi,annotatedPeakEnsTSS.df,by=intersect(ensMgi$ensembl_gene_id,annotatedPeakEnsTSS.df$feature),all=TRUE,sort=F)
ensMgi$ensembl_gene_id[1:5]
annotatedPeakEnsTSS.df$feature[1:5]
class(ensMgi$ensembl_gene_id[1:5])
class(annotatedPeakEnsTSS.df$feature[1:5])
dim(ensMgi)
dim(annotatedPeakEnsTSS.df)
merge(ensMgi,annotatedPeakEnsTSS.df,by=intersect(ensMgi$ensembl_gene_id,as.numeric(annotatedPeakEnsTSS.df$feature)),all=TRUE,sort=F)
source("http://bioconductor.org/biocLite.R")
biocLite("gtools")
biocLite("MEDIPS")
q()
